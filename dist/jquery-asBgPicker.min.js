/**
* jQuery asBgPicker
* a jquery plugin
* Compiled: Tue Aug 16 2016 16:30:47 GMT+0800 (CST)
* @version v0.1.1
* @link https://github.com/amazingSurge/jquery-asBgPicker
* @copyright LGPL-3.0
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["exports","jQuery"],t);else if("undefined"!=typeof exports)t(exports,require("jQuery"));else{var a={exports:{}};t(a.exports,e.jQuery),e.jqueryAsBgPicker=a.exports}}(this,function(e,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=a(t),n=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),l={namespace:"",skin:null,image:"images/defaults.png",lang:"en",repeat:{defaultValue:"repeat",values:["no-repeat","repeat","repeat-x","repeat-y"],tpl:function(){return'<div class="{{namespace}}-repeat"><span class="{{namespace}}-repeat-title">{{strings.bgRepeat}}</span><ul class="{{namespace}}-repeat-content"><li class="repeat_no-repeat"></li><li class="repeat_repeat"></li><li class="repeat_repeat-x"></li><li class="repeat_repeat-y"></li></ul></div>'}},position:{defaultValue:"top left",values:["top left","top center","top right","center left","center center","center right","bottom left","bottom center","bottom right"],tpl:function(){return'<div class="{{namespace}}-position"><span class="{{namespace}}-position-title">{{strings.bgPosition}}</span><ul class="{{namespace}}-position-content"><li class="postion_top-left"></li><li class="postion_top-center"></li><li class="postion_top-right"></li><li class="postion_center-left"></li><li class="postion_center-center"></li><li class="postion_center-right"></li><li class="postion_bottom-left"></li><li class="postion_bottom-center"></li><li class="postion_bottom-right"></li></ul></div>'}},size:{defaultValue:"auto",values:["auto","cover","contain","100% 100%"],tpl:function(){return'<div class="{{namespace}}-size"><span class="{{namespace}}-size-title">{{strings.bgSize}}</span><ul class="{{namespace}}-size-content"><li class="size_adapt-auto"></li><li class="size_adapt-width"></li><li class="size_adapt-height"></li><li class="size_adapt-all"></li></ul></div>'}},attachment:{namespace:"asDropdown",defaultValue:"scroll",values:["scroll","fixed","inherit"],tpl:function(){return'<div class="{{namespace}}-attachment"><span class="{{namespace}}-attachment-title">{{strings.bgAttach}}</span><div class="{{namespace}}-attachment-content"><div class="{{attachNamespace}} {{namespace}}-dropdown-trigger"><i class="asIcon-caret-down"></i></div><ul><li class="attachment_scroll">scroll</li><li class="attachment_fixed">fixed</li><li class="attachment_default">default</li></ul></div></div>'}},tpl:function(){return'<div class="{{namespace}}"><div class="{{namespace}}-initiate"><i></i>{{strings.placeholder}}</div><div class="{{namespace}}-info"><div class="{{namespace}}-info-image"><i></i><span class="{{namespace}}-info-image-name">{{strings.placeholder}}</span></div><div class="{{namespace}}-info-change">{{strings.change}}</div><a class="{{namespace}}-info-remove" href=""></a></div><div class="{{namespace}}-expand"><a class="{{namespace}}-expand-close" href="#"></a><div class="{{namespace}}-expand-image-wrap"><div class="{{namespace}}-expand-image"></div></div></div></div>'},process:function(e){return e&&"undefined"!=typeof e.image&&""!==e.image?JSON.stringify(e):""},parse:function(e){return e?$.parseJSON(e):{}},getThumbnalil:function(e){var t=void 0,a=void 0,s=void 0,i=void 0;return t=e.match(/([\S]+[\/])([\S]+)(\.+\w+$)/i),i=t[1],s=t[2],a=t[3],0===s.search("thumbnail")?i+s+a:i+"thumbnail-"+s+a},select:function(){},onChange:function(){},strings:{}},o="asBgPicker";l.namespace=o;var c=function(){function e(t,a){s(this,e),this.element=t,this.$element=(0,i.default)(t),this.options=i.default.extend({},l,a,this.$element.data()),"undefined"==typeof e.Strings[this.options.lang]?this.lang="en":this.lang=this.options.lang,this.strings=i.default.extend({},e.Strings[this.lang],this.options.strings),this.namespace=this.options.namespace,this.classes={skin:this.namespace+"_"+this.options.skin,disabled:this.namespace+"_disabled",active:this.namespace+"_active",hover:this.namespace+"_hover",empty:this.namespace+"_empty",exist:this.namespace+"_exist",expand:this.namespace+"_expand"},this.$element.addClass(this.namespace+"-input"),this.disabled=!1,this.initialed=!1;var n=this;i.default.extend(n,{init:function(){this._createHtml(),this.options.skin&&this.$wrap.addClass(this.classes.skin),this.value=this.options.parse(this.$element.val()),this.set(this.value,!1),this.options.disabled&&this.disable(),this.value.image||this.$wrap.addClass(this.classes.empty),this.doSize.init(),this.doAttachment.init(),this.doPosition.init(),this.doRepeat.init(),this.$wrap.addClass(this.classes.exist),this._bindEvent(),this.initialed=!0,this._trigger("ready")},_bindEvent:function(){this.$initiate.on("click",function(){n.disabled||n.$wrap.addClass(n.classes.expand).removeClass(n.classes.exist)}),this.$info.on("mouseenter",function(){n.disabled||(0,i.default)(this).addClass(n.classes.hover)}).on("mouseleave",function(){n.disabled||(0,i.default)(this).removeClass(n.classes.hover)}),this.$change.on("click",function(){n.disabled||n.$wrap.addClass(n.classes.expand).removeClass(n.classes.exist)}),this.$remove.on("click",function(){if(!n.disabled)return n.clear(),!1}),this.$close.on("click",function(){if(!n.disabled)return n.$wrap.addClass(n.classes.exist).removeClass(n.classes.expand),!1}),this.$image.on("click",function(){n.disabled||n.options.select.call(n)})},_createHtml:function(){this.$wrap=(0,i.default)(this.options.tpl().replace(/\{\{namespace\}\}/g,this.namespace).replace(/\{\{strings.placeholder\}\}/g,this.strings.placeholder).replace(/\{\{strings.change\}\}/g,this.strings.change)),this.$element.after(this.$wrap),this.$initiate=(0,i.default)("."+this.namespace+"-initiate",this.$wrap),this.$info=(0,i.default)("."+this.namespace+"-info",this.$wrap),this.$infoImageName=(0,i.default)("."+this.namespace+"-info-image-name",this.$info),this.$remove=(0,i.default)("."+this.namespace+"-info-remove",this.$info),this.$change=(0,i.default)("."+this.namespace+"-info-change",this.$info),this.$expand=(0,i.default)("."+this.namespace+"-expand",this.$wrap),this.$close=(0,i.default)("."+this.namespace+"-expand-close",this.$expand),this.$imageWrap=(0,i.default)("."+this.namespace+"-expand-image-wrap",this.$expand),this.$image=(0,i.default)("."+this.namespace+"-expand-image",this.$expand)},_trigger:function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];var i=[n].concat(a);n.$element.trigger("asBgPicker::"+e,i),e=e.replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)});var l="on"+e;if("function"==typeof n.options[l]){var o;(o=n.options)[l].apply(o,a)}},_setState:function(e){e&&e!==n.options.image?n.$wrap.removeClass(n.classes.empty):n.$wrap.addClass(n.classes.empty)},_returnInfo:function(e){var t=void 0;e&&e!==n.options.image?(t=e.match(/([\S]+[\/])([\S]+\w+$)/i)[2],n.$infoImageName.text(t)):n.$infoImageName.text(n.strings.placeholder)},_update:function(){null===n.value&&(n.value={}),n.$element.val(n.val()),n._trigger("change",n.options.parse(n.val()),n.options.name,o)},doRepeat:{values:n.options.repeat.values,defaultValue:n.options.repeat.defaultValue,init:function(){var e=this,t=n.options.repeat.tpl().replace(/\{\{namespace\}\}/g,n.namespace).replace(/\{\{strings.bgRepeat\}\}/g,n.strings.bgRepeat);this.$tplRepeat=(0,i.default)(t),n.$imageWrap.after(this.$tplRepeat),this.$repeat=n.$expand.find("."+n.namespace+"-repeat"),this.$items=this.$repeat.find("li"),i.default.each(this.values,function(t,a){e.$items.eq(t).data("repeat",a)});var a="undefined"!=typeof n.value.repeat?n.value.repeat:this.defaultValue;this.set(a),this.bindEvent()},set:function(e){var t=!1;this.$items.removeClass(n.classes.active);for(var a=0;a<this.values.length;a++)e===this.values[a]&&(n.value.repeat=e,this.$items.eq(a).addClass(n.classes.active),n.$image.css({"background-repeat":e}),t=!0);t||this.set(this.defaultValue)},clear:function(){this.set(this.defaultValue)},bindEvent:function(){var e=this;this.$repeat.on("click","li",function(){if(!n.disabled){var t=(0,i.default)(this).data("repeat");return e.set(t),n._update(),!1}})}},doPosition:{values:n.options.position.values,defaultValue:n.options.position.defaultValue,init:function(){var e=this,t=n.options.position.tpl().replace(/\{\{namespace\}\}/g,n.namespace).replace(/\{\{strings.bgPosition\}\}/g,n.strings.bgPosition);this.$tplPosition=(0,i.default)(t),n.$imageWrap.after(this.$tplPosition),this.$position=n.$expand.find("."+n.namespace+"-position"),this.$items=this.$position.find("li"),i.default.each(this.values,function(t,a){e.$items.eq(t).data("position",a)});var a="undefined"!=typeof n.value.position?n.value.position:this.defaultValue;this.set(a),this.bindEvent()},set:function(e){var t=!1;this.$items.removeClass(n.classes.active);for(var a=0;a<this.values.length;a++)e===this.values[a]&&(n.value.position=e,this.$items.eq(a).addClass(n.classes.active),n.$image.css({"background-position":e}),t=!0);t||this.set(this.defaultValue)},clear:function(){this.set(this.defaultValue)},bindEvent:function(){var e=this;this.$position.on("click","li",function(){if(!n.disabled){var t=(0,i.default)(this).data("position");return e.set(t),n._update(),!1}})}},doSize:{values:n.options.size.values,defaultValue:n.options.size.defaultValue,init:function(){var e=this,t=n.options.size.tpl().replace(/\{\{namespace\}\}/g,n.namespace).replace(/\{\{strings.bgSize\}\}/g,n.strings.bgSize);this.$tplSize=(0,i.default)(t),n.$imageWrap.after(this.$tplSize),this.$size=n.$expand.find("."+n.namespace+"-size"),this.$items=this.$size.find("li"),i.default.each(this.values,function(t,a){e.$items.eq(t).data("size",a)});var a="undefined"!=typeof n.value.size?n.value.size:this.defaultValue;this.set(a),this.bindEvent()},set:function(e){var t=!1;this.$items.removeClass(n.classes.active);for(var a=0;a<this.values.length;a++)e===this.values[a]&&(n.value.size=e,this.$items.eq(a).addClass(n.classes.active),n.$image.css({"background-size":e}),t=!0);t||this.set(this.defaultValue)},clear:function(){this.set(this.defaultValue)},bindEvent:function(){var e=this;this.$size.on("click","li",function(){if(!n.disabled){var t=(0,i.default)(this).data("size");return e.set(t),n._update(),!1}})}},doAttachment:{values:n.options.attachment.values,defaultValue:n.options.attachment.defaultValue,init:function(){var e=this,t=n.options.attachment.tpl().replace(/\{\{attachNamespace\}\}/g,n.options.attachment.namespace).replace(/\{\{namespace\}\}/g,n.namespace).replace(/\{\{strings.bgAttach\}\}/g,n.strings.bgAttach);this.$tplAttachment=(0,i.default)(t),n.$imageWrap.after(this.$tplAttachment),this.$attachment=n.$expand.find("."+n.namespace+"-attachment"),this.$items=this.$attachment.find("li"),this.$dropdown=n.$expand.find("."+n.options.attachment.namespace),this.values=n.options.attachment.values,i.default.each(this.values,function(t,a){e.$items.eq(t).data("attachment",a)}),this.$dropdown.asDropdown({namespace:n.options.attachment.namespace,imitateSelect:!0,data:"attachment",onChange:function(e){n.disabled||(n.value.attachment=e,n._update(),n.$image.css({"background-attachment":n.value.attachment}))}});var a="undefined"!=typeof n.value.attachment?n.value.attachment:this.defaultValue;this.set(a)},set:function(e){var t=!1;this.$items.removeClass(n.classes.active);for(var a=0;a<this.values.length;a++)e===this.values[a]&&(this.$dropdown.data("asDropdown").set(e),t=!0);t||this.set(this.defaultValue)},clear:function(){this.set(this.defaultValue)}}}),this._trigger("init"),this.init()}return n(e,[{key:"val",value:function(e){if("undefined"==typeof e)return this.options.process(this.value);var t=this.options.parse(e);t?this.set(t):this.clear()}},{key:"set",value:function(e,t){this.value=e,this.setImage(e.image),t!==!1&&("undefined"!=typeof e.repeat?this.doRepeat.set(e.repeat):this.doRepeat.clear(),"undefined"!=typeof e.size?this.doSize.set(e.size):this.doSize.clear(),"undefined"!=typeof e.position?this.doPosition.set(e.position):this.doPosition.clear(),"undefined"!=typeof e.attachment?this.doAttachment.set(e.attachment):this.doAttachment.clear(),this._update())}},{key:"clear",value:function(e){if(this.value={},e!==!1){var t="";this.setImage(t),this.doRepeat.clear(),this.doSize.clear(),this.doPosition.clear(),this.doAttachment.clear(),this._update()}}},{key:"setImage",value:function(e){var t=void 0,a=this;if(this._setState(e),this._returnInfo(e),""===e||"undefined"==typeof e)this.$image.css({"background-image":"none"});else if(e||e!==this.options.image){t=this.options.getThumbnalil(e);var s=new Image;s.onload=function(){a.value.image=t,a._returnInfo(a.value.image),a.$image.css({"background-image":"url('"+a.value.image+"')"})},s.onerror=function(){a.value.image=e,a._returnInfo(e),a._update(),a.$image.css({"background-image":"none"})},s.src=t}}},{key:"setRepeat",value:function(e){this.doRepeat.set(e),this._update()}},{key:"setSize",value:function(e){this.doSize.set(e),this._update()}},{key:"setPosition",value:function(e){this.doPosition.set(e),this._update()}},{key:"setAttachment",value:function(e){this.doAttachment.set(e),this._update()}},{key:"get",value:function(){return this.value}},{key:"enable",value:function(){this.disabled=!1,this.$wrap.removeClass(this.classes.disabled)}},{key:"disable",value:function(){this.disabled=!0,this.$wrap.addClass(this.classes.disabled)}},{key:"destory",value:function(){this.$element.data(o,null),this.$wrap.remove(),this._trigger("destory")}}],[{key:"_jQueryInterface",value:function(t){for(var a=arguments.length,s=Array(a>1?a-1:0),n=1;n<a;n++)s[n-1]=arguments[n];if("string"==typeof t){if(/^\_/.test(t))return!1;if("val"!==t||0!==s.length)return this.each(function(){var e=i.default.data(this,o);e&&"function"==typeof e[t]&&e[t].apply(e,s)});var l=this.first().data(o);if(l&&"function"==typeof l[t])return l[t].apply(l,s)}return this.each(function(){i.default.data(this,o)||i.default.data(this,o,new e(this,t))})}}]),e}();c.Strings={},c.localize=function(e,t){c.Strings[e]=t},c.localize("en",{placeholder:"Add Image",change:"change",bgRepeat:"Repeat",bgPosition:"Position",bgAttach:"Attach",bgSize:"Scalling"}),i.default.fn[o]=c._jQueryInterface,i.default.fn[o].constructor=c,i.default.fn[o].noConflict=function(){return i.default.fn[o]=JQUERY_NO_CONFLICT,c._jQueryInterface},e.default=c});